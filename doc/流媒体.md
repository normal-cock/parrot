
# 概念

HLS 技术对媒体流进行分段，并使用 M3U8 文件作为流媒体的索引文件

# 工具

本地m3u8可以使用VLC播放。

# EXT-X-START

待测试是否有效

# EXT-X-PART

为了减少发布延迟，引入了EXT-X-PART和EXT-X-PART-INF tag，示例m3u8如下所示，也就是在片段还没有最终成型的时候就将片段的part（类似CMAF的chunk）先发布出来，EXT-X-PART-INF包含了片段part的最长时长，服务器必须每隔EXT-X-PART-INF时长就发布一个片段part。同时part必须是“完整的”part才能发布，也就是说不能再阻塞客户端、占用CDN额外时间等待片段part生成。这个片段part的格式和CMAF也是兼容的。

# mp3->m3u8

`ffmpeg -i The.First.World.War.3.mp3 -hls_time 10 -hls_list_size 5 -hls_segment_filename 'filename-%d.ts' output.m3u8`

转码时，hls_list_size的作用。
* 测试一下，本地上传，`hls_list_size`小于总切片数时，能否正常上传，上传后能否正常播放——能正常上传，也能正常播放，但只会播放m3u8里面包含的切片。且上传后，m3u8的内容会改变，主要是文件地址
    * 上传: 
    * 播放: https://www.hlsplayer.org/ ——可以正常播放
        * 从该网站的例子视频上看，m3u8文件中包含了所有的ts信息。

原m3u8
```
#EXTM3U
#EXT-X-VERSION:3
#EXT-X-TARGETDURATION:10
#EXT-X-MEDIA-SEQUENCE:58
#EXTINF:10.005333,
audio-58.ts
#EXTINF:9.984000,
audio-59.ts
#EXTINF:10.005333,
audio-60.ts
#EXTINF:10.005333,
audio-61.ts
#EXTINF:6.848000,
audio-62.ts
#EXT-X-ENDLIST

```

aliyun点播功能上传后，再下载得到的m3u8
```
#EXTM3U
#EXT-X-VERSION:3
#EXT-X-TARGETDURATION:10
#EXT-X-MEDIA-SEQUENCE:58
#EXTINF:10.005333,
audio-58.ts?Expires=1728033871&OSSAccessKeyId=LTAI4FocoL6tuCdYhuvug6Ee&Signature=E%2BxhzudlZBelI8AVlT0hec7sxE4%3D
#EXTINF:9.984000,
audio-59.ts?Expires=1728033871&OSSAccessKeyId=LTAI4FocoL6tuCdYhuvug6Ee&Signature=1a2mQF0BbJ3q1EUJU9Sf057nWZ4%3D
#EXTINF:10.005333,
audio-60.ts?Expires=1728033871&OSSAccessKeyId=LTAI4FocoL6tuCdYhuvug6Ee&Signature=CRnLPvpbzJmabxkRPb9%2BDx78bVg%3D
#EXTINF:10.005333,
audio-61.ts?Expires=1728033871&OSSAccessKeyId=LTAI4FocoL6tuCdYhuvug6Ee&Signature=zamI9uTakopTisy8gaNcoNuKEfw%3D
#EXTINF:6.848000,
audio-62.ts?Expires=1728033871&OSSAccessKeyId=LTAI4FocoL6tuCdYhuvug6Ee&Signature=9ewMMBHBaCUoMxQ32iEd%2FDIWLp0%3D
#EXT-X-ENDLIST

```